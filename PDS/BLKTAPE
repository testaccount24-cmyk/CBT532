<<BLKTAPE>>
:
:COMPUTE BLOCK SIZES FOR TAPE
:
IF (A1 EQ '')
   RESPONSE 'BLKTAPE recsize'
   RETURN
ENDIF
DECLARE L1 BLK
DECLARE L2 MAX
DECLARE L3 REC
DECLARE L4 TXT <3>
LET REC = A1
:
LET MAX = 32760
IF (REC GT MAX)
   GOTO <<WRITE>>
ENDIF
LET BLK = (MAX / REC) * REC
LET TXT <1> = BLK
:
LET MAX = 16384
IF (REC GT MAX)
   GOTO <<WRITE>>
ENDIF
LET BLK = (MAX / REC) * REC
LET TXT <2> = BLK
:
LET MAX = 8192
IF (REC GT MAX)
   GOTO <<WRITE>>
ENDIF
LET BLK = (MAX / REC) * REC
LET TXT <3> = BLK
<<WRITE>>
WRITE
' LARGE BLOCK SIZE: '|TXT <1>
'MEDIUM BLOCK SIZE: '|TXT <2>
' SMALL BLOCK SIZE: '|TXT <3>
ENDWRITE
