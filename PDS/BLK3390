<<BLK3390>>
:
:COMPUTE BLOCK SIZES FOR 3390
:
IF (A1 EQ '')
   RESPONSE 'BLK3390 RECSIZE'
   RETURN
ENDIF
IF (A1 GT 32760)
   RESPONSE 'MVS MAXIMUM BLOCK SIZE IS 32760'
   RETURN
ENDIF
::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
 LET L1 = 27998 / A1 * A1
 LET L2 = 10796 / A1 * A1
 RESPONSE 'BLKSIZE='|L1|'***FIVEBLOCKS='|L2
 RETURN
::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
DECLARE L1 BLK
DECLARE L2 WRK
DECLARE L3 PTK
DECLARE L4 REC
DECLARE L5 TXT <12>
IF (A1 GT 27998)
   LET TXT <1> = A1
   GOTO <<WRITE>>
ENDIF
LET REC  = A1
LOOP PTK FROM 1 TO 12 BY 1
   LET WRK = (((1790 / PTK) - 20) * 32) - 2
   IF (WRK LT REC)
      GOTO <<WRITE>>
   ENDIF
   LET BLK = (WRK / REC) * REC
   LET TXT <PTK> = BLK
ENDLOOP
<<WRITE>>
WRITE
'    FULL TRACK BLOCK SIZE: '|TXT <1>
'    HALF TRACK BLOCK SIZE: '|TXT <2>
'   THIRD TRACK BLOCK SIZE: '|TXT <3>
' QUARTER TRACK BLOCK SIZE: '|TXT <4>
'   FIFTH TRACK BLOCK SIZE: '|TXT <5>
'   SIXTH TRACK BLOCK SIZE: '|TXT <6>
' SEVENTH TRACK BLOCK SIZE: '|TXT <7>
'   EIGTH TRACK BLOCK SIZE: '|TXT <8>
'   NINTH TRACK BLOCK SIZE: '|TXT <9>
'   TENTH TRACK BLOCK SIZE: '|TXT <10>
'ELEVENTH TRACK BLOCK SIZE: '|TXT <11>
' TWELFTH TRACK BLOCK SIZE: '|TXT <12>
ENDWRITE
